image: docker:latest

services:
  - docker:dind

stages:
  - evaluate

before_script:
  - cp -R src src_copy

variables:
  PYTHONPATH: $PYTHONPATH:$(pwd)/src_copy/scenarios/tools:$(pwd)/src_copy/utils/:$(pwd)/src_copy/isolate/

evaluate:
  image : registry.gitlab.com/projet-long/autotester2/my-custom-image:latest
  stage: evaluate
  script:
    - apt-get install gettext-base
    - apt-get install -y curl jq
    - export PYTHONPATH=$PYTHONPATH:./src_copy/utils
    - export PYTHONPATH=$PYTHONPATH:./src_copy/utils:./src_copy/scenarios/results
    - export PYTHONPATH=$PYTHONPATH:./src_copy/isolate
    - export PYTHONPATH=$PYTHONPATH:./src_copy/main
    - sh src/main/main_pipeline.sh
